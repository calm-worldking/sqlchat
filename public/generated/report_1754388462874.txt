Отчёт

На основании предоставленных данных о численности населения среднего возраста в различных городах, можно выделить города, в которых их количество существенно выше. В данном списке лидируют города Тараз и Семей с населением среднего возраста 155 и 144 соответственно, что свидетельствует о значительной доле людей среднего возраста. Также среди городов с повышенной численностью можно отметить Алматы (131), Караганду (122) и Экибастуз (90). Города с меньшим количеством населения среднего возраста включают Шымкент (81), Астану и Усть-Каменогорск (по 42), Кызылорду и Костанай (по 35), Актау (29) и Талдыкорган (27). Таким образом, города с наибольшим количеством людей среднего возраста расположены в верхней части списка, а именно Тараз, Семей, Алматы, Караганда и Экибастуз.

SQL: SELECT
  c.location AS city,
  COUNT(u.id) AS middle_age_population
FROM
  users u
JOIN
  companies c ON u.company_id = c.company_id
WHERE
  u.birth_date IS NOT NULL
  AND DATE_PART('year', AGE(u.birth_date)) BETWEEN 35 AND 55
GROUP BY
  c.location
ORDER BY
  middle_age_population DESC;